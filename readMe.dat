<html>

<head>
    <title></title>

    <script type="text/javascript">
	var inputCount=0;
   function populate() {

    var table = document.getElementById("mytable");
    var tbody = table.getElementsByTagName("tbody")[0];
    var rows = tbody.getElementsByTagName("tr");

    function populateRow (index, addBlurEvent) {
    var row = rows[index];
    var cells = row.getElementsByTagName("td")
    var textboxes = row.getElementsByTagName("input");

    var amountTextbox = textboxes[0];
    var totalTextbox = textboxes[1];
    var costCell = cells[1];

    var amount = amountTextbox.value.length>0 ? parseFloat(amountTextbox.value) : 0;
    var cost = parseFloat(costCell.innerHTML);
    var total = amount * cost;
    totalTextbox.value = total;

    if (addBlurEvent) {
    amountTextbox.onblur = function () { populateRow(index, false); };
    }

    }

    for (i = 0; i < rows.length; i++)
    {
      populateRow(i, true);
    }
	calcTotal();
    }



function addRow(name,marketPrice)
{
         if (!document.getElementsByTagName) return;
         tabBody=document.getElementsByTagName("tbody").item(0);
         inputCount++;
	 row=document.createElement("tr");
	 row.setAttribute("id" , inputCount);
         cell1 = document.createElement("td");
	 cell2 = document.createElement("input");
         cell3 = document.createElement("td");
         cell4 = document.createElement("input");
	 var btn = document.createElement('input');
	 btn.type = "button";
	 btn.className = "btn";
	 btn.value = "Delete Me!";
	 btn.onclick = function() { deleteRow(this) };
	 

   	 textnode1=document.createTextNode(name);
 	 textnode2=document.createTextNode(name);
         textnode3=document.createTextNode(marketPrice);
	 
	 

         cell1.appendChild(textnode1);
         cell2.appendChild(textnode2);
	 cell3.appendChild(textnode3);
	
	

         row.appendChild(cell1);
         row.appendChild(cell2);
	 row.appendChild(cell3);
	 row.appendChild(cell4);
	 row.appendChild(btn);

	 cell2.addEventListener("blur", populate, false);
	 
	 cell4.addEventListener("blur", populate, false);
         tabBody.appendChild(row);


}

function calcTotal(){

    var table = document.getElementById("mytable");
    var tbody = table.getElementsByTagName("tbody")[0];
    var rows = tbody.getElementsByTagName("tr");
    var totalCount=0;
    var count=0;
    for (i = 0; i < rows.length; i++)
    {
    var row = rows[i];
    var cells = row.getElementsByTagName("td");
    var textboxes = row.getElementsByTagName("input");

    count = parseInt(textboxes[1].value);

    totalCount = count + totalCount;
    
    document.getElementById('totalVal').innerHTML= totalCount; 
    }

}

function deleteRow(row)
{
    var i=row.parentNode.rowIndex;
    document.getElementById('mytable').deleteRow(i);
	calcTotal();
}


function addRowNow(){

var e = document.getElementById("mySelector");
var val = e.options[e.selectedIndex].value;

var newVal= val.split(":");

addRow(newVal[0], newVal[1]);
console.log(newVal[1]);

}

</script>

</head>

<body>
<h4>Select an item to purchas</h4>
<select id="mySelector">
  <option value="item1:10">Stock 1</option>
  <option value="item2:11">Stock 2</option>
  <option value="item3:12">Stock 3</option>
  <option value="item4:13">Stock 4</option>
</select>
<br><br>

    <form action="">
    <table border="1" cellpadding="5" id="mytable">
        <thead>
            <tr>
                <th>Stock Name</th>
                <th>Buy Quantity</th>
                <th>Market Price</th>
                <th>Amount</th>
		<th>Action</th>
            </tr>
        </thead>
        <tbody>
            
        </tbody>
    </table>
    </form>

<input type="button" onclick="addRowNow()" value="Add Row" >


<br><br>
<label>Total Cost is : </label>
<p id="totalVal">No item/quantity is selected: </p>

</body>

</html>